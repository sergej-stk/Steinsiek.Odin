@page "/"
@inject IProductApiClient ProductApi
@inject ICategoryApiClient CategoryApi

<PageTitle>Odin - Modern E-Commerce</PageTitle>

<div class="hero-section mb-4">
    <h3 class="fw-bold">Welcome to Odin</h3>
    <p class="mb-3" style="opacity: 0.85;">Discover our curated collection of premium products</p>
    <a href="/products" class="btn btn-light">
        Browse Products <i class="bi bi-arrow-right ms-1"></i>
    </a>
</div>

@if (_categories is not null)
{
    <h5 class="fw-semibold mb-3">Categories</h5>
    <div class="d-flex flex-wrap gap-2 mb-4">
        @foreach (var category in _categories.Data)
        {
            <a href="/products?category=@category.Id" class="badge text-bg-primary text-decoration-none fs-6 fw-normal py-2 px-3">
                <i class="bi bi-grid me-1"></i> @category.Name
            </a>
        }
    </div>
}

<h5 class="fw-semibold mb-3">Featured Products</h5>
@if (_products is null)
{
    <LoadingIndicator />
}
else
{
    <ProductGrid Products="_products.Data" />
}

@code {
    private ListResult<ProductDto>? _products;
    private ListResult<CategoryDto>? _categories;

    /// <inheritdoc />
    protected override async Task OnInitializedAsync()
    {
        var productsTask = ProductApi.GetAll(CancellationToken.None);
        var categoriesTask = CategoryApi.GetAll(CancellationToken.None);
        await Task.WhenAll(productsTask, categoriesTask);
        _products = productsTask.Result;
        _categories = categoriesTask.Result;
    }
}
