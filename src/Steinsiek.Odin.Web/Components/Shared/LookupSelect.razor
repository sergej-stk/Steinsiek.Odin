<div class="mb-3">
    @if (!string.IsNullOrEmpty(Label))
    {
        <label class="form-label">@Label</label>
    }
    <select class="form-select" @bind="SelectedValue" @bind:after="OnSelectionChanged">
        @if (!IsRequired)
        {
            <option value="">&mdash; Select &mdash;</option>
        }
        @if (Items is not null)
        {
            @foreach (var item in Items)
            {
                <option value="@item.Id">@item.Value</option>
            }
        }
    </select>
</div>

@code {
    /// <summary>
    /// The label displayed above the select input.
    /// </summary>
    [Parameter]
    public string? Label { get; set; }

    /// <summary>
    /// The list of lookup items to populate the dropdown.
    /// </summary>
    [Parameter]
    public IReadOnlyList<LookupDto>? Items { get; set; }

    /// <summary>
    /// The currently selected value.
    /// </summary>
    [Parameter]
    public Guid? Value { get; set; }

    /// <summary>
    /// Callback invoked when the selected value changes, enabling two-way binding.
    /// </summary>
    [Parameter]
    public EventCallback<Guid?> ValueChanged { get; set; }

    /// <summary>
    /// Whether a selection is required, hiding the placeholder option.
    /// </summary>
    [Parameter]
    public bool IsRequired { get; set; }

    /// <summary>
    /// Gets or sets the selected value for internal binding.
    /// </summary>
    private Guid? SelectedValue
    {
        get => Value;
        set => Value = value;
    }

    /// <summary>
    /// Notifies the parent component when the selection changes.
    /// </summary>
    private async Task OnSelectionChanged()
    {
        await ValueChanged.InvokeAsync(Value);
    }
}
